general:
  branches:
    only:
      - packaging_circleci

machine:
  services:
    - docker

## Customize dependencies
dependencies:
  pre:
    - gem install --no-ri --no-rdoc package_cloud
    - docker run -v $(pwd):/p -i -t klou/dod-precise-builder make -f /p/package/Makefile package
    # - docker run -v $(pwd):/p -i -t klou/dod-trusty-builder make -f /p/package/Makefile package

deployment:
  production:
    branch: packaging_circleci
    commands:
      - package_cloud push klou/ex/ubuntu/precise $(pwd)/package/ubuntu/precise
      # - package_cloud push klou/ex/ubuntu/trusty $(pwd)/package/ubuntu/trusty